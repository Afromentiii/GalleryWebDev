if galleries && galleries.length > 0
  h2 Twoje galerie
  each gallery in galleries
    div(style='border:1px solid #ccc; margin-bottom:20px; padding:10px')
      h3 #{gallery.name}

      form(action=`/dashboard/gallery/delete/${gallery._id}`, method='POST', style='display:inline')
        button(type='submit', onclick="return confirm('Na pewno chcesz usunąć tę galerię?')") Usuń galerię

      form(action=`/dashboard/gallery/${gallery._id}/add-image`, method='POST', enctype='multipart/form-data')
        label(for=`image_${gallery._id}`) Dodaj obrazek do galerii:
        input(type='file', name='image', id=`image_${gallery._id}`, accept='image/*', required)
        button(type='submit') Dodaj obrazek

      if gallery.images && gallery.images.length > 0
        ul(style='margin-top:10px; display:flex; gap:10px; list-style:none; padding:0; flex-wrap: wrap;')
          each img in gallery.images
            li(style='position: relative; border:1px solid #ddd; padding:5px; max-width: 180px;')
              img(src=img.path, alt=img.name, style='max-width:150px; max-height:150px; display:block; margin-bottom: 5px;')

              // Usuwanie obrazka (przycisk "X" w rogu)
              form(action=`/dashboard/image/delete/${img._id}`, method='POST', style='position: absolute; top: 5px; right: 5px;')
                button(type='submit', onclick="return confirm('Na pewno chcesz usunąć ten obrazek?')", style='background: rgba(255,0,0,0.7); color: white; border: none; padding: 2px 6px; cursor: pointer; font-size: 12px; border-radius: 3px;')
                  | X

              // Nazwa i opis wyświetlane na stałe
              p(style='font-weight: bold; margin-bottom: 3px;') #{img.name}
              p(style='font-size: 0.9em; color: #555; margin-top: 0; margin-bottom: 5px;') #{img.description || 'Brak opisu'}

              // Przycisk do pokazania/ukrycia formularza edycji
              button(type='button', class='toggle-edit-btn', style='margin-bottom: 5px; cursor: pointer;') ⚙️ Edytuj

              // Formularz edycji, domyślnie ukryty
              form(action=`/dashboard/image/edit/${img._id}`, method='POST', style='display:none;', id=`editForm_${img._id}`)
                label(for=`name_${img._id}`) Nazwa:
                input(type='text', id=`name_${img._id}`, name='newName', value=img.name, required)
                button(type='submit') Zapisz

else
  p Nie masz jeszcze żadnych galerii.

//- Skrypt do toggle edycji
script.
  document.addEventListener('DOMContentLoaded', () => {
    document.querySelectorAll('.toggle-edit-btn').forEach(button => {
      button.addEventListener('click', () => {
        const form = button.nextElementSibling;
        if (form.style.display === 'none' || form.style.display === '') {
          form.style.display = 'block';
          button.textContent = '✖ Anuluj';
        } else {
          form.style.display = 'none';
          button.textContent = '⚙️ Edytuj';
        }
      });
    });
  });
